Выполнил все по заданию.
Не получилось реализовать количество элементов для конретного элемента с уровня выше.
